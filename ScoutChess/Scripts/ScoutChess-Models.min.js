(function(){var i,t,r,n;t="brown";r="pink";n={pawn:"pawn",rook:"rook",knight:"knight",bishop:"bishop",queen:"queen",king:"king"};window.ScoutChess=function(){var o,s,u,f,e,l,a,h,c;for(this.pieces=[],this.turn=t,this.selectedPiece=ko.observable(),this.selectPiece=function(n){if(n.team===this.turn)return this.selectedPiece(n)},this.isOccupied=function(n,t){return this.pieces.some(function(i){return i.column()===n&&i.row()===t})},s=function(n,t){return n>=0&&n<8&&t>=0&&t<8},this.getMoves=function(i){var o,r,e,c,f,u,l,h,a;f=[];switch(i.rank){case n.pawn:e=i.team===t?1:-1;f.push({column:i.column()+e,row:i.row()});i.initiated==null&&f.push({column:i.column()+e*2,row:i.row()});break;case n.rook:for(u=i.row()-1;!(u<0||this.isOccupied(i.column(),u));)f.push({column:i.column(),row:u}),u--;for(u=i.row()+1;!(u>7||this.isOccupied(i.column(),u));)f.push({column:i.column(),row:u}),u++;for(r=i.column()+1;!(r>7||this.isOccupied(r,i.row()));)f.push({column:r,row:i.row()}),r++;for(r=i.column()-1;!(r<0||this.isOccupied(r,i.row()));)f.push({column:r,row:i.row()}),r--;break;case n.knight:for(c=[[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1],[-2,-1],[-2,1]],h=0,a=c.length;h<a;h++)e=c[h],r=e[0]+i.column(),u=e[1]+i.row(),s(r,u)&&!this.isOccupied(r,u)&&f.push({column:r,row:u});break;case n.bishop:l=this;o=function(n,t){var e;for(r=i.column()+n,u=i.row()+t,e=[];!(!s(r,u)||l.isOccupied(r,u));)f.push({column:r,row:u}),r+=n,e.push(u+=t);return e};o(-1,-1);o(-1,1);o(1,-1);o(1,1)}return f},this.move=function(n,i){if(this.selectedPiece()!=null)return this.selectedPiece().column(n),this.selectedPiece().row(i),this.selectedPiece().initiated=!0,this.selectedPiece(null),this.turn=this.turn===t?r:t},o=function(t,r){var u,f,e,o;return o=function(n){return r?7-n:n},f=function(){var r,u;for(u=[],e=r=0;r<8;e=++r)u.push(new i(t,n.pawn,o(1),e));return u}(),u=function(n,r){return f.push(new i(t,n,o(0),r))},u(n.rook,0),u(n.knight,1),u(n.bishop,2),u(n.queen,3),u(n.king,4),u(n.bishop,5),u(n.knight,6),u(n.rook,7),f},h=o(t),f=0,l=h.length;f<l;f++)u=h[f],this.pieces.push(u);for(c=o(r,!0),e=0,a=c.length;e<a;e++)u=c[e],this.pieces.push(u);return this};i=function(n,t,i,r){return this.team=n,this.rank=t,this.column=ko.observable(i),this.row=ko.observable(r),this}}).call(this);